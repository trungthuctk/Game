<script>
    var shoppingCartItems = [];
    var quantify_total = 0;
    var price_total = 0;
    var total = 0;
    $(document).ready(function() {
        // Kiểm tra nếu đã có sessionStorage["shopping-cart-items"] hay chưa?
        if (sessionStorage["shopping-cart-items"] != null) {
            shoppingCartItems = JSON.parse(sessionStorage["shopping-cart-items"].toString());
        }

        // Hiển thị thông tin từ giỏ hàng
        // displayShoppingCartItems();
    });
    $(".add").click(function() {
        var button = $(this); // Lấy đối tượng button mà người dùng click
        var name = button.attr("data-name"); // name của sản phẩm là thuộc tính data-name của button
        var price = button.attr("data-price"); // price của sản phẩm là thuộc tính data-price của button
        var quantity = 1; // Số lượng
        total++;

        var item = {

            name: name,
            price: price,
            quantity: quantity
        };

        var exists = false;
        if (shoppingCartItems.length > 0) {
            $.each(shoppingCartItems, function(index, value) {
                // Nếu mặt hàng đã tồn tại trong giỏ hàng thì chỉ cần tăng số lượng mặt hàng đó trong giỏ hàng.
                if (value.name == item.name) {
                    value.quantity++;
                    exists = true;
                    return false;
                }
            });
        }

        // Nếu mặt hàng chưa tồn tại trong giỏ hàng thì bổ sung vào mảng
        if (!exists) {
            shoppingCartItems.push(item);
        }

        // Lưu thông tin vào sessionStorage
        sessionStorage["shopping-cart-items"] = JSON.stringify(shoppingCartItems); // Chuyển thông tin mảng shoppingCartItems sang JSON trước khi lưu vào sessionStorage
        // Gọi hàm hiển thị giỏ hàng
        displayShoppingCartItems();
    });


    function displayShoppingCartItems() {
        if (sessionStorage["shopping-cart-items"] != null) {
            shoppingCartItems = JSON.parse(sessionStorage["shopping-cart-items"].toString()); // Chuyển thông tin từ JSON trong sessionStorage sang mảng shoppingCartItems.

            $("#table-products > ul").html("");
            // Duyệt qua mảng shoppingCartItems để append từng item dòng vào table
            $.each(shoppingCartItems, function(index, item) {
                var htmlString = "";
                htmlString += "<li>";

                htmlString += "<h4>" + item.name + "</h4>";

                htmlString += "<span style='text-align: right'>" + item.quantity + "</span>";
                htmlString += "<div style='text-align: right'>" + (item.price * item.quantity) / 1000 + ".000 Đ </div>";
                htmlString += "</li>";

                $("#table-products > ul:last").append(htmlString);
                quantify_total += item.quantity;
                price_total += (item.price * item.quantity);


            });
            $("#table-products").html;
            $("#table-products").append(quantify_total);
            $("#price_total").html("");
            $("#price_total").append(price_total / 1000);
        }
    }
</script>